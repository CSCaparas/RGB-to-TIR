# RGB2TIR
Code used to create pix2pix-based machine learning model for RGB to thermal image translation.
Also includes some of the dataset and results from our trained model.

Model:

  Training set size: 2137 
  
  Validation set size: 916 
  
  Epochs: 100 

Code files with a * are modified from code provided by Emma Wadsworth: https://github.com/apisdn 

# Code

### Data Capture:

  combined.py* opens a live side-by-side video feed of the RGB camera and thermal camera. This was used to calibrate/align the cameras prior to data capture.

  thermography.py* is used to simultaneously capture the RGB and thermal images used in the dataset. RGB returned as png files; thermal returnes as csv files.

  changefilename_paired.py was used to compile all captured RGB and thermal images (that we wanted to include in our dataset) into a single folder and assign each pair a unique file name.

### Pix2Pix:

  model.py* contains the main pix2pix code, including how the loss is being calcuated
  
  networks.py* contains the main unet code 
  
  dataset_CC.py* contains how the dataset is being imported, read, and converted for use in the pix2pix model
  
  run_experiment_CC.py* contains the primary training and validation loops for running the model (this is the code that will actually be run) 

### Ground Truth:

groundtruththermal.py converts all csv files with paired generated .tiff files (validation set) into groundtruth thermal images. We used this to generate groundtruth .png files for our visulaization. Note: Do NOT use these saved images for training the pix2pix model or calculating MSE or SSIM scores. 
  
lookatthermal_CC.py* converts a single csv file (captured by the thermal camera) into a contrast thermal image. We used this code to visualize individual groundtruth images as needed and to make sure the groundtruth image being generated inside the pix2pix model matched the csv thermal map 

### Comparison Scores: 

MSE_SSIM.py compares every generated .tiff file to its groundtruth image (as generated from the .csv file) to calculate a MSE and SSIM score. Scores are compiled in an excel for each individual pair as well as calculating the mean and median scores for the entire (validation) set.  

MSE_SSIM_single.py compares a single (specified) generated .tiff file to its groundtruth image (as generated from the .csv file) to calculate a MSE and SSIM score. Generated and groundtruth image are plotted side by side with MSE and SSIM scores. This code does not automatically save the generated plot, and was used to look at specific pairs (such as the image pairs with the highest or lowest SSIM or MSE scores)   

# Dataset & Results
  
  Dataset: Paired RGB (png) and thermal (csv) images used to train pix2pix model 

  Results: Side by side (png) of groundtruth thermal maps generated from csv files with fake thermal images generated by our pix2pix model after 100 epochs
  
  Model Logs: Graphs and logs tracking loss values over epoch, as captured by wandb

  Comparison Scores: MSE and SSIM scores
