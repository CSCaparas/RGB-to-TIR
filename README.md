# RGB-to-TIR
Code used to create pix2pix-based machine learning model for RGB to thermal image translation.
Also includes results from our trained model.

The intention of building this model was to test the potential of monitoring plant health using predicted thermal data from RGB images

Code files with a * are modified from code provided by Emma Wadsworth: https://github.com/apisdn 

# Trained Model Info

  Training set size: 2137 

  Validation set size: 916 
  
  Epochs: 100

  Mean MSE: 5792

  Mean SSIM: 0.422

# Code

### Data Capture:

  combinedBH.py* opens a live side-by-side video feed of the RGB camera and thermal camera. This was used to calibrate/align the cameras prior to data capture.

  thermographyBH.py* is used to simultaneously capture the RGB and thermal images used in the dataset. RGB returned as png files; thermal returned as csv files.

  seekcamera.dll* is the .dll file used in "combinedBH.py" and "thermographyBH.py" to identify the thermal and RGB cameras plugged into the computer (via USB). 

  changefilename_paired.py was used to compile all captured RGB and thermal images (that we wanted to include in our dataset) into a single folder and assign each pair a unique file name.

### Pix2Pix:

  model.py* contains the main pix2pix code, including how the loss is being calcuated
  
  networks.py* contains the main unet code 
  
  dataset_CC.py* contains how the dataset is being imported, read, and converted for use in the pix2pix model
  
  run_experiment_CC.py* contains the primary training and validation loops for running the model (this is the code that will actually be run when training the model). Validation loop will create generated thermal images as .tiff files (we used ImageJ to view the .tiff files).   

### Ground Truth:

groundtruththermal.py converts all csv files with paired generated .tiff files (validation set) into groundtruth thermal images. We used this to generate groundtruth .png files for our visualization. Note: Do NOT use these saved images for training the pix2pix model or calculating MSE or SSIM scores. 
  
lookatthermal_CC.py* converts a single csv file (captured by the thermal camera) into a contrast thermal image. We used this code to visualize individual groundtruth images as needed and to make sure the groundtruth image being generated inside the pix2pix model matched the csv thermal map 

### Combined Scores: 

MSE_SSIM.py compares every generated .tiff file to its groundtruth image (as generated from the .csv file) to calculate a MSE and SSIM score. Scores are compiled in an excel for each individual pair as well as calculating the mean and median scores for the entire (validation) set. No images generated or saved. 

MSE_SSIM_all.py; all generated .tiff files are plotted side by side to their groundtruth images (as generated from the .csv file) with MSE and SSIM scores and saved.

MSE_SSIM_single.py; same as "all" version, but lets you look at a single image pair at a time. The generated side-by-side image is not automatically saved. 

# Dataset & Results

Dataset: Small sample of dataset used to train model 
  
Results: Side by side (png) of groundtruth thermal maps generated from csv files with fake thermal images generated by our pix2pix model after 100 epochs. Raw generated .tiff files not included. 
  
Model Logs: Graphs and logs tracking loss values over epoch, as captured by wandb. Can also be viewed at: https://api.wandb.ai/links/constance-caparas-university-of-utah/nhnabf6b

Comparison Scores: MSE and SSIM scores
